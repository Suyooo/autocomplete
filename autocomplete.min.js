!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).autocomplete=t()}(this,(function(){"use strict";return function(e){var t=document,n=e.container||t.createElement("div");n.id=n.id||"autocomplete-"+(Date.now().toString(36)+Math.random().toString(36).substring(2));var i,o,r=n.style,a=navigator.userAgent,d=~a.indexOf("Firefox")&&~a.indexOf("Mobile"),s=e.debounceWaitMs||0,u=e.preventSubmit||!1,l=e.disableAutoSelect||!1,c=d?"input":"keyup",f=[],p="",v=2,m=e.showOnFocus,g=0;if(void 0!==e.minLength&&(v=e.minLength),!e.input)throw new Error("input undefined");var h=e.input;function b(){o&&window.clearTimeout(o)}function A(){return!!n.parentNode}function w(){var e;g++,f=[],p="",i=void 0,h.setAttribute("aria-activedescendant",""),h.setAttribute("aria-expanded","false"),(e=n.parentNode)&&e.removeChild(n)}function E(e){var t,n,i;return e.length+((null===(t=e.at(-1))||void 0===t?void 0:t.charCodeAt(0))||-1)+((null===(n=e.at(-2))||void 0===n?void 0:n.charCodeAt(0))||-1)+((null===(i=e.at(-3))||void 0===i?void 0:i.charCodeAt(0))||-1)}function x(){for(;n.firstChild;)n.removeChild(n.firstChild);h.setAttribute("aria-activedescendant","");var o=function(e,n,i){var o=t.createElement("div");return o.textContent=e.label||"",o};e.render&&(o=e.render);var a=function(e,n){var i=t.createElement("div");return i.textContent=e,i};e.renderGroup&&(a=e.renderGroup);var d=t.createDocumentFragment(),s="#9?$";if(f.forEach((function(t,r){if(t.group&&t.group!==s){s=t.group;var u=a(t.group,p);u&&(u.className+=" group",d.appendChild(u))}var l=o(t,p,r);l&&(l.id=n.id+"_"+r+"_"+E(p),l.setAttribute("role","option"),l.addEventListener("click",(function(n){e.onSelect(t,h),w(),n.preventDefault(),n.stopPropagation()})),t===i&&(l.className+=" selected",l.setAttribute("aria-selected","true"),h.setAttribute("aria-activedescendant",l.id)),d.appendChild(l))})),n.appendChild(d),f.length<1){if(!e.emptyMsg||!p)return void w();var u=t.createElement("div");u.id=n.id+"_e_"+E(p),u.className="empty",u.textContent=e.emptyMsg,n.appendChild(u),h.setAttribute("aria-activedescendant",u.id)}n.parentNode||t.body.appendChild(n),function(){if(A()){h.setAttribute("aria-expanded","true"),r.height="auto",r.width=h.offsetWidth+"px";var i,o=0;a(),a(),e.customize&&i&&e.customize(h,i,n,o)}function a(){var e=t.documentElement,n=e.clientTop||t.body.clientTop||0,a=e.clientLeft||t.body.clientLeft||0,d=window.pageYOffset||e.scrollTop,s=window.pageXOffset||e.scrollLeft,u=(i=h.getBoundingClientRect()).top+h.offsetHeight+d-n,l=i.left+s-a;r.top=u+"px",r.left=l+"px",(o=window.innerHeight-(i.top+h.offsetHeight))<0&&(o=0),r.top=u+"px",r.bottom="",r.left=l+"px",r.maxHeight=o+"px"}}(),function(){var e=n.getElementsByClassName("selected");if(e.length>0){var t=e[0],i=t.previousElementSibling;if(i&&-1!==i.className.indexOf("group")&&!i.previousElementSibling&&(t=i),t.offsetTop<n.scrollTop)n.scrollTop=t.offsetTop;else{var o=t.offsetTop+t.offsetHeight,r=n.scrollTop+n.offsetHeight;o>r&&(n.scrollTop+=o-r)}}}()}function y(){A()&&x()}function L(){y()}function C(e){e.target!==n?y():e.preventDefault()}function T(t){for(var n=t.which||t.keyCode||0,i=0,o=e.keysToIgnore||[38,13,27,39,37,16,17,18,20,91,9];i<o.length;i++){if(n===o[i])return}n>=112&&n<=123&&!e.keysToIgnore||40===n&&A()||S(0)}function k(t){var n=t.which||t.keyCode||0;if(38===n||40===n||27===n){var o=A();if(27===n)w();else{if(!o||f.length<1)return;38===n?function(){if(f.length<1)i=void 0;else if(i===f[0])i=f[f.length-1];else for(var e=f.length-1;e>0;e--)if(i===f[e]||1===e){i=f[e-1];break}}():function(){if(f.length<1&&(i=void 0),i&&i!==f[f.length-1]){for(var e=0;e<f.length-1;e++)if(i===f[e]){i=f[e+1];break}}else i=f[0]}(),x()}return t.preventDefault(),void(o&&t.stopPropagation())}13===n&&(i&&(e.onSelect(i,h),w()),u&&t.preventDefault())}function N(){m&&S(1)}function S(t){var n=++g,r=h.value,a=h.selectionStart||0;r.length>=v||1===t?(b(),o=window.setTimeout((function(){e.fetch(r,(function(e){g===n&&e&&(p=r,i=(f=e).length<1||l?void 0:f[0],x())}),t,a)}),0===t?s:0)):w()}function D(){setTimeout((function(){t.activeElement!==h&&w()}),200)}return n.className="autocomplete "+(e.className||""),n.setAttribute("role","listbox"),h.setAttribute("role","combobox"),h.setAttribute("aria-expanded","false"),h.setAttribute("aria-autocomplete","list"),h.setAttribute("aria-controls",n.id),h.setAttribute("aria-owns",n.id),h.setAttribute("aria-activedescendant",""),h.setAttribute("aria-haspopup","listbox"),r.position="absolute",n.addEventListener("mousedown",(function(e){e.stopPropagation(),e.preventDefault()})),n.addEventListener("focus",(function(){return h.focus()})),h.addEventListener("keydown",k),h.addEventListener(c,T),h.addEventListener("blur",D),h.addEventListener("focus",N),window.addEventListener("resize",L),t.addEventListener("scroll",C,!0),{destroy:function(){h.removeEventListener("focus",N),h.removeEventListener("keydown",k),h.removeEventListener(c,T),h.removeEventListener("blur",D),window.removeEventListener("resize",L),t.removeEventListener("scroll",C,!0),h.removeAttribute("role"),h.removeAttribute("aria-expanded"),h.removeAttribute("aria-autocomplete"),h.removeAttribute("aria-controls"),h.removeAttribute("aria-owns"),h.removeAttribute("aria-activedescendant"),h.removeAttribute("aria-haspopup"),b(),w()}}}}));
//# sourceMappingURL=autocomplete.min.js.map
